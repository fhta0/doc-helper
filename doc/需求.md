# 文档格式检查系统需求文档

## **1. 项目概述**

### 1.1 项目背景

开发一个简洁易用的文档格式检查Web应用，支持Word和WPS文档，帮助用户快速检查论文格式问题。

### 1.2 项目目标

* 支持Word (.docx) 和 WPS (.wps) 文档
* 提供基础格式检查和AI深度检查
* 按次收费，无需VIP会员制
* 微信扫码一键登录

### 1.3 核心价值

* ​**快速**​：快速完成论文检查
* ​**准确**​：结合规则引擎和AI分析
* ​**经济**​：按次付费，用完再买
* ​**便捷**​：微信扫码注册和登录

---

## **2. 用户角色**

### 2.1 普通用户

| 属性                 | 描述            |
| ---------------------- | ----------------- |
| **身份**​     | 学生、研究人员  |
| **登录方式**​ | 微信扫码        |
| **免费额度**​ | 每月3次基础检查 |
| **付费方式**​ | 按次购买检测包  |

### 2.2 管理员

| 属性                 | 描述                         |
| ---------------------- | ------------------------------ |
| **身份**​     | 系统运营人员                 |
| **权限**​     | 用户管理、次数管理、规则配置 |
| **登录方式**​ | 微信扫码+管理员账号          |

---

## **3. 核心功能**

### 3.1 用户系统

#### 3.1.1 登录认证

* 微信扫码登录（唯一登录方式）
* 自动返回登录状态

#### 3.1.2 个人中心

* 剩余检查次数显示
* 检查记录列表
* 已购次数记录
* 微信头像/昵称显示

### 3.2 次数管理系统

#### 3.2.1 免费额度

* 每个用户每月3次基础检查
* 每月1日自动重置
* 基础检查包含：页面设置、字体、段落等固定规则

#### 3.2.2 购买选项

```
检测包购买选项：
1. 基础检测包
   - 10次检测：20元
   - 包含：基础规则检查
   
2. 完整检测包
   - 10次检测：50元
   - 包含：基础规则检查 + AI深度分析
   
3. 单次检测
   - 1次完整检测：8元
   - 即买即用
```

#### 3.2.3 扣费规则

* 基础检查：消耗基础检测次数
* AI深度检查：消耗完整检测次数
* 余额不足时提示购买
* 支持混合使用不同类型次数

### 3.3 论文检查功能

#### 3.3.1 文档上传

* 拖拽上传或选择文件
* 支持格式：.docx, .wps
* 文件大小限制：10MB
* 实时上传进度

#### 3.3.2 检查类型选择

```
请选择检查类型：
○ 基础检查（免费/基础次数）
  - 页面设置、字体、段落、编号等
  - 无需AI分析
  
◎ 完整检查（完整次数）
  - 包含所有基础检查
  - 增加AI深度分析：
    * 图文一致性
    * 引用准确性
    * 逻辑连贯性
```

#### 3.3.3 基础检查内容

通过配置文件管理，包括：

* 页面设置（尺寸、边距）
* 字体样式（中英文字体、字号）
* 段落格式（缩进、行距）
* 标题编号
* 图表公式格式
* 参考文献格式

#### 3.3.4 AI深度检查

* 图文一致性分析
* 引用准确性验证
* 章节逻辑评估
* 术语规范性检查
* 摘要质量评估

#### 3.3.5 检查报告

* 问题分类统计
* 详细问题列表（位置、描述、建议）
* 一键导出（PDF）

### 3.4 管理后台

#### 3.4.1 用户管理

* 用户列表（微信昵称、手机、注册时间）
* 剩余次数查看
* 手动赠送次数（用于客服补偿）

#### 3.4.2 规则管理

* 基础检查规则配置
* 错误消息模板编辑

#### 3.4.3 订单管理

* 购买记录查看
* 手动补单
* 退款处理

---

## **4. 核心业务流程**

### 4.1 新用户首次使用

```
1. 访问网站
2. 点击"微信扫码登录"
3. 微信扫码并确认
5. 进入控制台，显示剩余次数
6. 上传论文开始检查
```

### 4.2 检查流程

```
1. 控制台点击"上传论文"
2. 选择检查类型：
   - 基础检查（使用免费/基础次数）
   - 完整检查（使用完整次数）
3. 上传文档
4. 自动开始检查
5. 实时显示进度
6. 查看检查报告
```

### 4.3 购买流程

```
1. 次数不足时提示购买
2. 选择检测包类型
3. 微信支付
4. 支付成功自动到账
5. 返回继续检查
```

### 4.4 管理流程

```
1. 管理员扫码登录
2. 输入管理密码
3. 进入管理后台
4. 管理用户/规则/订单
```

---

## **5. 页面设计**

### 5.1 页面清单（5个页面）

```
1. 首页 (index.html)         - 登录入口
2. 控制台 (dashboard.html)   - 用户主界面
3. 检查页 (check.html)       - 上传和结果
4. 购买页 (purchase.html)    - 购买检测包
5. 管理后台 (admin.html)     - 管理员界面
```

### 5.2 首页设计

```
[导航栏] - Logo | 空

[主内容区 - 居中对齐]
1. 产品Logo + 名称
2. 一句话描述
   "文档格式检查，一扫即用"
   
3. 微信登录按钮（大号绿色按钮）
   [微信扫码登录]
   
4. 特性说明（小字）
   - 每月3次免费基础检查
   - 支持Word和WPS文档
   - 基础+AI深度分析
   
[页脚]
- 客服微信
- 隐私协议
```

### 5.3 控制台设计

```
顶部状态栏：
[微信头像] [昵称] [退出]

主内容区：
1. 次数卡片
   🆓 本月免费次数：3/3
   🔧 基础检测剩余：5次
   🤖 完整检测剩余：2次
   [购买更多]

2. 上传区域
   [📤 上传论文检查]（大按钮）
   
3. 最近检查（最多5条）
   - 论文1.docx | 基础检查 | 85分
   - 论文2.docx | 完整检查 | 92分
   
侧边栏菜单：
- 检查历史
- 购买记录
- 个人设置
```

### 5.4 检查页面设计

```
步骤指示器：
① 上传文档 → ② 检查中 → ③ 查看结果

步骤1：上传和选择
- 拖拽上传区域
- 检查类型选择：
  ○ 基础检查（免费/基础次数）
  ◎ 完整检查（完整次数）
- 开始检查按钮

步骤2：检查中
- 进度条动画
- 检查项列表
- 预计剩余时间

步骤3：结果
- 总体评分：85/100
- 问题统计：
  🔴 严重：2个
  🟡 警告：5个
  💡 建议：3个
- 问题详情（可展开）
- 操作按钮：
  [重新检查] [导出报告] [返回]
```

### 5.5 购买页面设计

```
选择检测包：
1. 基础检测包
   🎯 10次基础检测
   💰 价格：20元
   [立即购买]
   
2. 完整检测包
   🎯 10次完整检测
   📊 含AI深度分析
   💰 价格：50元
   [立即购买]
   
3. 单次检测
   🎯 1次完整检测
   💰 价格：8元
   [立即购买]
   
已购次数显示：
- 基础检测：5次
- 完整检测：2次
```

### 5.6 管理后台设计

```
登录后显示：
[简单管理面板]

1. 用户管理
   - 搜索用户（微信昵称/手机）
   - 用户列表（昵称、手机、次数、时间）
   - 操作：[赠送次数] [查看记录]
   
2. 规则管理
   - 规则列表（名称）
   - 操作：[编辑] [删除]
   
3. 订单管理
   - 订单列表（时间、用户、金额、状态）
   - 操作：[查看详情] [补单]
   
4. 系统状态
   - 今日活跃用户
   - 今日检查次数
   - 今日收入
```

---

## **6. 技术架构**

### 6.1 前端技术

* Vue 3 + Vite
* Element Plus组件库
* 微信JS-SDK（扫码登录）

### 6.2 后端技术

* FastAPI (Python)
* MySQL数据库
* 微信支付API
* OpenAI/Claude API（AI检查）

### 6.3 数据库设计

```
-- 用户表
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    wechat_openid VARCHAR(128) UNIQUE,
    nickname VARCHAR(64),
    avatar VARCHAR(256),
    phone VARCHAR(20),
    free_count INT DEFAULT 3,      -- 本月免费次数
    basic_count INT DEFAULT 0,     -- 购买的基础次数
    full_count INT DEFAULT 0,      -- 购买的完整次数
    last_reset_date DATE,          -- 上次免费次数重置日期
    created_at TIMESTAMP
);

-- 检查记录表
CREATE TABLE checks (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,
    filename VARCHAR(255),
    check_type ENUM('basic', 'full'),
    score INT,
    result_json TEXT,
    cost_type ENUM('free', 'basic', 'full'),
    created_at TIMESTAMP
);

-- 订单表
CREATE TABLE orders (
    id VARCHAR(32) PRIMARY KEY,    -- 订单号
    user_id INT,
    package_type ENUM('basic_10', 'full_10', 'single'),
    amount DECIMAL(10,2),          -- 金额
    status ENUM('pending', 'paid', 'failed', 'refunded'),
    paid_at TIMESTAMP NULL,
    created_at TIMESTAMP
);

-- 规则配置表
CREATE TABLE rules (
    id VARCHAR(50) PRIMARY KEY,
    name VARCHAR(100),
    category VARCHAR(50),
    condition_json JSON,
    error_message TEXT,
    suggestion TEXT
);
```

### 6.4 微信支付流程

```
1. 用户选择检测包
2. 系统创建预支付订单
3. 调用微信支付API生成支付参数
4. 前端调起微信支付
5. 用户支付
6. 微信异步回调通知
7. 系统确认支付，增加次数
8. 页面跳转回购买成功页
```

---

## **7. 配置规则管理**

### 7.1 规则存储

* 基础检查规则存储在数据库
* 管理员通过后台界面管理
* 支持编辑、删除

### 7.2 规则分类

1. ​**页面设置**​：尺寸、边距
2. ​**字体样式**​：中英文字体、字号
3. ​**段落格式**​：缩进、行距
4. ​**标题编号**​：章节编号格式
5. ​**图表公式**​：编号、标题位置
6. ​**参考文献**​：格式、引用

### 7.3 规则管理界面

```
规则管理页
├── 规则列表
│   ├── ID: PAGE_A4
│   ├── ID: FONT_TITLE
│   └── ID: MARGIN_25
├── 搜索框
└── 操作按钮
    ├── [添加规则]
    ├── [编辑]
    └── [删除]
```




## **9. 计费与成本**

### 9.1 用户费用

```
基础检测包：2元/次
完整检测包：5元/次
单次检测：8元/次
```

### 9.2 成本估算

```
AI成本：约0.5-1元/次（完整检查）
服务器成本：约500元/月
支付手续费：0.6%
```

### 9.3 免费额度控制

* 每月1日自动重置免费次数
* 仅限基础检查
* 不可累积，过期作废
* 不与购买次数叠加使用


